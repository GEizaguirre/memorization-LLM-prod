Q18) 
The Large Volume Customer Query ranks customers based on their having placed a large quantity order. Large 
quantity orders are defined as those orders whose total quantity is above a certain level. 
2.4.18.1 Business Question 
The Large Volume Customer Query finds a list of the top 100 customers who have ever placed large quantity orders. 
The query lists the customer name, customer key, the order key, date and total price and the quantity for the order. 
2.4.18.2 Functional Query Definition 
Return the first 100 selected rows 
select  
c_name, 
c_custkey,  
o_orderkey, 
o_orderdate, 
o_totalprice, 
sum(l_quantity) 
from  
customer, 
orders, 
lineitem 
where  
o_orderkey in ( 
select 
l_orderkey 
from 
lineitem 
group by  
l_orderkey having  
sum(l_quantity) > [QUANTITY] 
) 
and c_custkey = o_custkey 
and o_orderkey = l_orderkey 
group by  
c_name,  
c_custkey,  
o_orderkey,  
o_orderdate,  
o_totalprice 
order by  
o_totalprice desc, 
o_orderdate; 
2.4.18.3 Substitution Parameters 
Values for the following substitution parameter must be generated and used to build the executable query text: 
1. QUANTITY is randomly selected within [312..315]. 
2.4.18.4 Query Validation 
For validation against the qualification database the query must be executed using the following values for substitu-
tion parameters and must produce the following output data: 
Values for substitution parameters: 
1. QUANTITY = 300 
TPC BenchmarkTM H Standard Specification Revision 3.0.1 
Page 59 
2.4.18.5 Sample Output 
  
 
  
C_NAME 
C_CUSTKEY O_ORDERKE
Y 
O_ORDERDATE 
O_TOTALPRICE Sum(L_QUANTITY) 
Customer#000128120 
128120 
4722021 
1994-04-07 
544089.09 
323.00 
  
TPC BenchmarkTM H Standard Specification Revision 3.0.1 
Page 60 
2.4.19 
Discounted Revenue Query (