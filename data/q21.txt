Q21) 
This query identifies certain suppliers who were not able to ship required parts in a timely manner. 
2.4.21.1 Business Question 
The Suppliers Who Kept Orders Waiting query identifies suppliers, for a given nation, whose product was part of a 
multi-supplier order (with current status of 'F') where they were the only supplier who failed to meet the committed 
delivery date. 
2.4.21.2 Functional Query Definition 
Return the first 100 selected rows. 
select  
s_name,  
count(*) as numwait 
from  
supplier,  
lineitem l1,  
orders,  
nation 
where  
s_suppkey = l1.l_suppkey 
and o_orderkey = l1.l_orderkey 
and o_orderstatus = 'F' 
and l1.l_receiptdate > l1.l_commitdate 
and exists (  
select  
* 
from  
lineitem l2 
where  
l2.l_orderkey = l1.l_orderkey 
and l2.l_suppkey <> l1.l_suppkey 
) 
and not exists (  
select  
* 
from  
lineitem l3 
where  
l3.l_orderkey = l1.l_orderkey 
and l3.l_suppkey <> l1.l_suppkey 
and l3.l_receiptdate > l3.l_commitdate 
) 
and s_nationkey = n_nationkey 
and n_name = '[NATION]' 
group by  
s_name 
order by  
numwait desc,  
s_name; 
2.4.21.3 Substitution Parameters 
1. NATION is randomly selected within the list of values defined for N_NAME in Clause 4.2.3. 
2.4.21.4 Query Validation 
TPC BenchmarkTM H Standard Specification Revision 3.0.1 
Page 65 
For validation against the qualification database the query must be executed using the following values for substitu-
tion parameters and must produce the following output data: 
Values for substitution parameters: 
1. NATION = SAUDI ARABIA. 
2.4.21.5 Sample Output 
  
S_NAME 
NUMWAIT 
Supplier#000002829 
20 
  
TPC BenchmarkTM H Standard Specification Revision 3.0.1 
Page 66 
2.4.22 
Global Sales Opportunity Query (