Q1) 
This query reports the amount of business that was billed, shipped, and returned. 
2.4.1.1 Business Question 
The Pricing Summary Report Query provides a summary pricing report for all lineitems shipped as of a given date. 
The date is within 60 - 120 days of the greatest ship date contained in the database. The query lists totals for 
extended price, discounted extended price, discounted extended price plus tax, average quantity, average extended 
price, and average discount. These aggregates are grouped by RETURNFLAG and LINESTATUS, and listed in 
ascending order of RETURNFLAG and LINESTATUS. A count of the number of lineitems in each group is 
included. 
2.4.1.2 Functional Query Definition 
select 
l_returnflag,  
l_linestatus,  
sum(l_quantity) as sum_qty, 
sum(l_extendedprice) as sum_base_price, 
sum(l_extendedprice*(1-l_discount)) as sum_disc_price, 
sum(l_extendedprice*(1-l_discount)*(1+l_tax)) as sum_charge, 
avg(l_quantity) as avg_qty,  
avg(l_extendedprice) as avg_price, 
avg(l_discount) as avg_disc,  
count(*) as count_order 
from  
lineitem 
where  
l_shipdate <= date '1998-12-01' - interval '[DELTA]' day (3) 
group by  
l_returnflag,  
l_linestatus 
order by  
l_returnflag,  
l_linestatus; 
2.4.1.3 Substitution Parameters 
Values for the following substitution parameter must be generated and used to build the executable query text: 
 
1. 
DELTA is randomly selected within [60. 120]. 
 
Comment: 1998-12-01 is the highest possible ship date as defined in the database population. (This is ENDDATE - 
30). The query will include all lineitems shipped before this date minus DELTA days. The intent is to choose 
DELTA so that between 95% and 97% of the rows in the table are scanned. 
2.4.1.4 Query Validation 
For validation against the qualification database the query must be executed using the following values for substitu-
tion parameters and must produce the following output data: 
Values for substitution parameters: 
 
1. DELTA = 90. 
TPC BenchmarkTM H Standard Specification Revision 3.0.1 
Page 30 
 
2.4.1.5 Sample Output 
 
 
  
L_RETURNFLAG 
L_LINESTATUS 
SUM_QTY 
SUM_BASE_PRICE 
SUM_DISC_PRICE 
A 
F 
37734107.00 
56586554400.73 
53758257134.87 
  
  
SUM_CHARGE 
AVG_QTY 
AVG_PRICE 
AVG_DISC 
COUNT_ORDER 
55909065222.83 
25.52 
38273.13 
.05 
1478493 
  
2.4.2 
Minimum Cost Supplier Query (